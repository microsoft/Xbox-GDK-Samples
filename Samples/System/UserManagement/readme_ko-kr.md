  ![](./media/image1.png)

#   사용자 관리 샘플

*이 샘플은 Microsoft 게임 개발 키트와 호환됩니다(2020년 4월).*

# 

# 설명

이 샘플에서는 단일 사용자 시나리오와 다중 사용자 시나리오 모두에 대해
게임패드 연결을 사용하여 사용자 관리를 수행하는 방법을 보여 줍니다. 또한
관리 동작이 XR 규정을 준수하도록 참조용 예제를 제공합니다. 마지막으로
실행 관리자가 크로스 프로세스 사례에 대한 기본 사용자를 설정하는 방법을
보여 줍니다.

# 샘플 빌드

Xbox One 개발 키트를 사용하는 경우 활성 솔루션 플랫폼을
Gaming.Xbox.XboxOne.x64로 설정하세요.

Project Scarlett을 사용하는 경우 활성 솔루션 플랫폼을
Gaming.Xbox.Scarlett.x64로 설정하세요.

*자세한 내용은 GDK 문서에서* 샘플 실행하기*를 참조하세요.*

# 샘플 사용

샘플은 세 개의 화면으로 분한되며, 게임패드를 사용하여 화면을 전환할 수
있습니다. 입력 내용이 샘플의 화면에 아래와 같이 표시됩니다.

[제목 화면]{.underline}

![](./media/image3.png)

| 작업                             |  모든 게임패드                     |
|----------------------------------|-----------------------------------|
| 메뉴 탐색                        |  D-패드 위/아래로                  |
| 로그인/메뉴 옵션 선택            |  A 단추                            |
| 사용자 전환                      |  Y 단추                            |

[\
]{.underline}

[단일 사용자 화면]{.underline}

![](./media/image4.png)

| 작업  |  모든 게임패드  |  사용자의 연결된 게임패드                |
|----------------------|--------------------|-------------------------|
| 제목으로 돌아가기  |  (대화 상자에 메시지가 표시되는 경우) B 단추 |  주 메뉴 선택 |
| 로그아웃 지연 설정/해제 |  해당 없음  |  로그 아웃 시 요청 지연 선택                    |
| 선택/로그인/작업 확인(대화 상자)  |  (대화 상자에 메시지가 표시되는 경우) A 단추 |  A 단추 |
| 작업 취소(대화 상자) |  B 단추             |  해당 없음               |
| 탐색                 |  해당 없음          |  D-패드 위/아래로        |

[\
]{.underline}

[다중 사용자 화면]{.underline}

![](./media/image5.png)

| 작업  |  연결되지 않은 게임패드 |  사용자의 연결된 게임패드 |
|----------------------|-----------------|----------------------------|
| 제목으로 돌아가기(기본 사용자) |  해당 없음  |  주 메뉴 선택 |
| 로그인               |  A 단추          |  해당 없음                  |
| 로그 아웃(주 사용자가 아닌 사용자) |  해당 없음  |  나가기 선택 |
| 로그아웃 지연 설정/해제 |  해당 없음  |  로그 아웃 시 요청 지연 선택                       |
| 탐색                 |  해당 없음       |  D-패드 위/아래로           |

# 구현 참고 사항

이 샘플에서는 사용자 관리 기능의 데모를 단일 사용자 시나리오와 다중
사용자 시나리오로 나눕니다. 단일 사용자 화면에서는 데이터가 변경되거나
사용자의 연결이 끊긴 경우에 사용자 이벤트를 처리하면서 단일 기본
사용자를 관리하는 방법을 보여 줍니다. 다중 사용자 화면에서는 최대 4명의
사용자가 동시에 로그인할 수 있습니다.

또한 제목 화면에서*\"교차 재시작 테스트*\" 옵션은 새 프로세스에서 기본
사용자를 설정하기 위해 사용자 매개 변수와 함께 제공될 수 있는
**XLaunchNewGame()**를 사용하는 방법을 보여 줍니다. 이 기능에 일반적인
사용 사례로는 별도 실행 파일을 시작하는 시작 관리자가 있는 게임(예: 단일
플레이어 버전과 다중 플레이어 버전이 별도로 제공되는 게임)을 들 수
있습니다. 이 샘플에서는 시작할 때 사용자를 선택하라는 메시지를 표시하는
대신 기본 사용자로 게임에 직접 로그인하는 방법을 보여 줍니다.

다양한 화면에서 많은 사용자 관리 기능을 보여 줍니다. 기능 목록과 기능을
사용하는 방법은 다음 표를 참조하세요.

| 기능             |  설명                                              |
|------------------|---------------------------------------------------|
| 로그인  |  **XUserAddAsync()**는 제목 화면에서 샘플의 기본 사용자를 로그인하는 데 사용됩니다. 다중 사용자 화면의 경우 최대 3명의 추가 사용자가 샘플에 로그인하여 멀티플레이어 게임을 시연할 수 있습니다.                                         |
| 로그아웃  |  다중 사용자 시나리오에서는 로그인된 추가 사용자(기본 사용자가 아닌 사용자)를 샘플에서 수동으로 로그아웃할 수 있습니다. 기본 사용자는 샘플에서 수동으로 로그아웃할 수 없지만 Xbox 시스템 UI와 같은 다른 로그아웃 방법으로 연결을 끊을 수 있습니다.                                 |
| 사용자 전환  |  제목 화면에서 **XUserAddAsync()**를 사용하여 새 사용자를 성공적으로 로그인한 후 이전 사용자를 제거하여 현재 기본 사용자를 전환할 수 있습니다. 다중 사용자 화면에서는 기본 사용자가 아닌 사용자를 자유롭게 로그인 및 로그아웃할 수 있습니다.                                         |
| 사용자가 없는 게임  |  제목 화면에서 기본 사용자를 설정하지 않은 경우 로그인 UI가 취소될 수 있습니다. 그럴 경우 샘플에서는 사용자 없이 계속할지 여부를 묻고 데이터가 저장되지 않는다는 알림을 표시합니다. 진행할 경우 사용자 없이 단일 사용자 화면에 액세스할 수 있습니다. 이 샘플에서 \"사용자가 없는\" 게임에 대해 사용 가능한 유일한 조치는 디바이스에서 게임패드 입력을 보고 제목 화면으로 돌아가는 것입니다.                                |
| 게임패드 연결 및 입력  |  사용자 디바이스 연결 이벤트를 추적하여 모든 로그인한 사용자에게 연결되는 게임패드에 대한 최신 정보를 유지합니다. 모든 화면의 오른쪽에 있는 디바이스 패널의 연결된 게임패드 화면에 입력이 표시됩니다. 로그인 대화 상자, 컨트롤러 켜기/끄기, 사용자의 Xbox 시스템 UI 작업 등 다양한 소스로 인해 게임패드 연결이 변경됩니다.                       |
| 기본 사용자 로그인  |  이 샘플에서는 \"교차 재시작 테스트\" 메뉴 옵션을 사용하는 경우의 기본 사용자 로그인을 보여 줍니다. 새 프로세스에서는 시스템 UI를 사용하지 않고 로그인되게 하는 특수 플래그와 함께 **XUserAddAsync()**를 사용합니다. 로그인에 성공하면 샘플이 제목 화면에서 단일 사용자 화면으로 자동으로 진행됩니다.                     |
| **XLau nchNewGame()**을 통한 크로스 프로세스 기본 로그인  |  게임에 따라 실행 파일이 여러 개 있는 경우도 있고 단일 실행 파일에 여러 로딩 시나리오가 포함된 경우도 있습니다. 크로스 프로세스 시작을 위한 기본 사용자 설정을 지원하기 위해 **XLaunchNewGame()**이 사용됩니다. 이 샘플에서는 샘플에서 사용자를 선택하도록 하여 해당 방법을 보여 줍니다. 그런 다음 새로 생성된 프로세스에서 해당 사용자를 자동으로 로그인하고 단일 사용자 화면으로 진행합니다.                              |
| 사용자 데이터  |  게이머태그와 게이머 사진은 모든 로그인한 사용자의 화면에 표시됩니다.                                |
| 로그 아웃 지연  |  사용자가 UI에서 로그아웃을 시작하는 경우 로그아웃이 몇 초 지연될 수 있습니다.              |
| 사용자 이벤트 처리 |  사용자 이벤트는 로그아웃, 게이머태그 변경 및 게이머 사진 변경에 대해 처리됩니다.               |
| 처리 일시 중지/다시 시작  |  진행 중인 게이머 사진 요청은 처리가 일시 중지되면 취소되었다가 재개되면 다시 시작됩니다. 재개 후 사용자 이벤트를 처리하여 사용자 로그인 상태를 수정합니다. XR 고려 사항은 아래 XR 섹션을 참조하세요.         |
| 게스트 사용자  |  게스트 사용자는 다중 사용자 화면에서 **XUserAddAsync()**를 통해 로그인할 수 있습니다.  |

[ERA XDK의 차이점에 대한 참고 사항:]{.underline}

게임 코어 타이틀에서는 게임에서 **XUserAddAsync()** 함수를 호출하여
요청한 사용자하고만 상호 작용할 수 있습니다. 따라서 반환될 사용자가
타이틀에 추가되지 않은 경우 사용자를 반환하는 API가 실패합니다. 즉,
타이틀보다 많은 사용자가 시스템에 로그인할 수 있습니다. 타이틀 사용자를
지속적으로 일관되게 추적하고 사용자 디바이스 연결 콜백에서 게임패드 연결
변경을 관찰하는 것이 중요합니다.

[샘플 파일:]{.underline}

시연을 위해 샘플을 세 가지 기본 코드 영역으로 분할합니다.

*GameInputDevice.cpp/h*

게임패드 추적 및 관리는 **GameInputDevice** 및 **GameInputCollection**
클래스에서 **GameInput API**를 사용하여 처리됩니다. 연결된 게임의 최신
목록이 유지되고 모든 디바이스에 대한 입력을 확인할 수 있습니다.

*GameUser.cpp/h*

**GameUser** 및 **GameUserManager** 클래스를 구현하여 사용자 관리 기능을
보여 줍니다. 이러한 클래스는 사용자 로그인, 게임패드 연결 업데이트,
이벤트 처리 등과 같은 작업을 수행하는 방법을 보여 줍니다.

**GameUserManager**는 일반적인 방식으로 구현되며 단일 사용자 시나리오와
다중 사용자 시나리오를 지원하는 데 사용될 수 있습니다.

*GameScreens.cpp/h*

타이틀의 다양한 화면이 여기서 구현됩니다. 화면에서 샘플 UI를 표시하고
**GameUserManager** 기능을 사용하여 사용자 관리 기능을 보여 줍니다.
**GameUserManager**의 사용자는 **GameScreenManager**에서 관리됩니다.
따라서 단일 위치에서 다양한 게임 화면의 게임 사용자 상태를 추적할 수
있습니다.

**GameScreenSingleUser** 클래스는 단일 사용자 시나리오와 유사한 게임이고
**GameScreenMultiUser** 클래스는 다중 사용자를 지원하는 게임의 다중
사용자 버전입니다. **GameScreenTitle**은 제목 화면용 클래스입니다.

# 게임 코어용 XR

게임 코어의 사용자 ID 및 관리용 XR이 해당 ERA 기능보다 간소화되었습니다.
기본적으로 이 샘플에서 규정 준수를 위해 보여주는 세 가지 관련 요구
사항을 따라야 합니다. "***XR-112**: 초기 활성화 및 재시작 중에 사용자 및
컨트롤러 설정*", "***XR-115***: *게임 중에 사용자 또는 컨트롤러 추가 및
제거*", "***XR-046**: 표시 이름 및 게이머 사진*". 각 XR과 샘플에서 XR을
따르는 방법이 아래에 설명되어 있습니다. 전체 XR 정보는
<https://developer.microsoft.com/en-us/games/xbox/partner/certification-requirements>에서
확인할 수 있습니다.

[**XR-112**: 초기 활성화 및 재시작 중에 사용자 및 컨트롤러
설정]{.underline}

요구 사항 요약:

-   타이틀의 기본 사용자를 한 명 이상 설정해야 합니다.

    -   사용자가 로그인을 취소할 경우 사용자 없이 계속할 경우 저장되지
        않는다는 경고가 표시됩니다.

-   사용자 관련 작업을 수행하기 전에 사용자를 표시해야 합니다.

-   타이틀의 기본 사용자를 변경하려면 계정 선택기에 입력해야 합니다.

-   일시 중지 또는 제악 상태에서 다시 시작할 경우 타이틀에서 사용자 및
    게임패드 연결의 유효성을 검사해야 합니다.

이 샘플에서 처리되는 방법은 다음과 같습니다.

-   활성 사용자가 로그인하지 않은 경우 제목 화면에서 활성 사용자를
    설정합니다.

-   UI에서 샘플 용도로 활성 사용자를 식별합니다.

-   기본 사용자 선택을 취소하면 경고가 표시됩니다.

    -   기본 사용자가 로그인하지 않은 경우 다중 사용자는 비활성화되지만
        단일 사용자 화면에 액세스할 수 있습니다.

-   게임패드 연결은 항상 사용자 디바이스 연결 콜백에서 업데이트되고
    적용됩니다.

-   사용자가 로그인했지만 연결된 게임패드가 없는 경우 연결되지 않은
    게임패드로 다시 연결하여 새 게임패드를 연결할 수 있습니다.

-   항상 응용 프로그램을 다시 시작하는 모든 이벤트를 처리하여 사용자
    상태를 수정합니다.

[**XR-115**: 게임 중에 사용자 또는 컨트롤러 추가 및 제거]{.underline}

요구 사항 요약:

-   기본 사용자와 게임패드를 설정한 이후에 멀티플레이어 타이틀에서 추가
    사용자 및 게임패드를 사용할 수 있습니다. 추가 사용자를 타이틀에
    추가하는 방법을 고려해야 합니다.

-   플레이어의 컨트롤러가 제거된 경우 타이틀에서 디바이스 연결 콜백 또는
    **XUserAddAsync()** 호출을 통한 새 컨트롤러 재설정을 허용해야
    합니다.

-   게임 중에 플레이어를 제거한 경우 타이틀에서 플레이어를 제거하거나
    사용자 및 활성 컨트롤러를 다시 설정해야 합니다.

이 샘플에서 처리되는 방법은 다음과 같습니다.

-   제목 화면 또는 다중 사용자 화면에서 기본 사용자의 연결이 끊긴 경우
    샘플이 제목 화면으로 되돌아가고 로그인 프롬프트가 표시됩니다.

-   단일 사용자 화면에서 기본 사용자의 연결이 끊긴 경우 사용자를 다시
    설정해 보라는 메시지가 표시됩니다.

-   다중 사용자 화면에서 기본 사용자가 아닌 사용자의 연결이 끊긴 경우
    해당 사용자가 타이틀에서 제거됩니다.

-   사용자의 연결된 게임패드가 없는 경우 항상 게임패드 설정 옵션이
    표시됩니다.

-   샘플에서는 임의의 게임패드, 연결되지 않은 게임패드 또는 연결된
    게임패드를 통해 작업을 처리할 수 있는 경우를 명시적으로 보여 줍니다.

[**XR-046**: 표시 이름 및 게이머 사진]{.underline}

요구 사항 요약:

-   Xbox Live를 사용하는 게임 타이틀에서는 플레이어의 게이머태그를
    플레이어의 게임 내 ID 이름으로 사용해야 합니다.

이 샘플에서 처리되는 방법은 다음과 같습니다.

-   이 타이틀은 온라인으로 재생되지 않지만 항상 **XUserGetGamertag()**
    호출에 의해 반환되는 게이머태그를 사용하여 모든 로그인한 사용자를
    식별합니다.

# 시도할 만한 사항

다음 각 작업은 사용자 관리와 관련된 몇 가지 중요한 시나리오를 보여
줍니다. 화면의 변경 내용과 디버거의 출력 로그를 확인합니다.

1)  **작업**: 시작 후 제목 화면에서 로그인을 시작했다가 취소합니다.\
    **관찰**: 이 샘플에서는 이제 계속하면 저장할 수 있다는 경고를
    표시합니다. 계속하면 샘플에서 단일 사용자 화면으로 진행할 수
    있습니다.

2)  **작업**: 제목 화면에서 사용자를 로그인합니다. Y 단추를 사용하여
    사용자를 전환해 봅니다.\
    **관찰**: 제목 화면에서 기본 사용자를 변경할 수 있으므로 항상
    사용자가 변경될 수 있습니다.

3)  **작업**: 기본 사용자로 로그인한 다음 다른 화면에서 Xbox 시스템 UI를
    사용하여 사용자를 로그아웃합니다.\
    **관찰**: 화면마다 기반으로 하는 동작이 다릅니다. 로그아웃하면
    타이틀 및 다중 사용자 화면이 계속 진행됩니다. 단일 사용자 화면에는
    로그인을 다시 허용하라는 메시지가 표시됩니다.

4)  **작업**: 기본 사용자로 로그인하고 단일 사용자 화면으로 진행합니다.
    그런 다음 컨트롤러를 끕니다.\
    **관찰**: 화면에 표시되는 게임패드 연결 정보는 켜진 컨트롤러와 해당
    연결 상태에 따라 변경됩니다. 게임패드가 켜져 있지 않은 경우 연결된
    게임패드가 없다는 알림 메시지가 화면에 표시됩니다. 연결되지 않은
    게임패드만 켜져 있는 경우 연결된 게임패드가 없다는 메시지와 연결되지
    않은 게임패드로 로그인할지 묻는 범례 메시지가 샘플에 표시됩니다.

5)  **작업**: 다중 사용자 화면에서 한 명 이상의 사용자가 샘플에
    로그인합니다. Xbox 시스템 UI를 사용하여 사용자의 게이머태그 또는
    게이머 사진을 변경합니다.\
    **관찰**: 게이머태그 또는 게이머 사진이 샘플에 올바르게 표시되도록
    업데이트됩니다.

6)  **작업**: 한 명 이상의 사용자가 샘플에 로그인합니다. Xbox One
    Manager를 사용하여 응용 프로그램을 일시 중지하고, Xbox 시스템 UI에서
    한 명 이상의 사용자를 로그아웃한 다음 응용 프로그램을 다시
    시작합니다.\
    **관찰**: 사용자가 계속 로그인되어 있는 경우 올바른 사용자가
    정상적인 상태로 로그인했는지 확인하기 위해 응용 프로그램에서 적절한
    단계를 수행합니다. 기본 사용자를 제거한 경우 샘플에서 적절히
    처리합니다.

7)  **작업**: 여러 사용자가 다중 사용자 환경에 로그인합니다. 그런 다음
    Xbox 시스템 UI를 사용하여 다른 게이머패드에서 현재 사용자를
    전환합니다.\
    **관찰**: 각 로그인한 사용자에 대한 화면에서 게임패드 연결이
    일치하도록 업데이트됩니다.

8)  **작업**: 단일 사용자 또는 다중 사용자 화면에서 일부 게임패드를 켜고
    다른 게임패드의 단추를 누릅니다.\
    **관찰**: 입력 내용이 해당 게임패드와 어떻게 연계되는지 확인합니다.

# FAQ

1)  내 콘솔에 게임패드가 하나만 연결되어 있는 상태에서 게임패드가 두 개
    이상 나열되는 이유는 무엇인가요?\
    **응답**: Xbox One Manager가 실행 중이고 개발자 키트에 연결되어 있는
    경우 컨트롤러 목록에 게임패드로 표시될 수 있습니다. Xbox One
    Manager를 종료하고 컨트롤러 제거됨 이벤트를 확인하세요.

2)  Xbox One Manager의 게임패드를 사용하여 로그인할 때 게임패드가
    연결되지 않는 이유는 무엇인가요?\
    **응답**: 드롭다운 선택을 사용하여 Xbox One Manager의 게임패드를
    다른 사용자에게 연결할 수 있습니다. 해당 연결은 해당 게임패드에
    적용됩니다.

# 업데이트 기록

**초기 릴리스:** Microsoft 게임 개발 키트(2020년 4월)

# 개인정보처리방침

샘플을 컴파일하고 실행할 때 샘플의 사용을 추적하는 데 도움이 되도록 샘플
실행 파일의 파일 이름이 Microsoft에 전송됩니다. 이 데이터 수집을
옵트아웃하려면 Main.cpp에서 \"샘플 사용 원격 분석\"이라고 레이블이
지정된 코드 블록을 제거할 수 있습니다.

Microsoft의 일반 개인정보취급방침에 대한 자세한 내용은 [Microsoft
개인정보처리방침](https://privacy.microsoft.com/en-us/privacystatement/)을
참조하세요.
