  ![](./media/image1.png)

#   シンプルなユーザー モデルのサンプル

*このサンプルは Microsoft Game Development Kit (2021 年 4 月)
と互換性があります*

# 

# 説明

このサンプルでは、Microsoft Game Development Kit (2021 年 4 月)
で導入された新しいシンプル ユーザー モデルを使用する方法を示します。

# サンプルのビルド

Xbox One 開発キットを使用している場合、アクティブ ソリューション
プラットフォームを Gaming.Xbox.XboxOne.x64 に設定します。

Xbox Series X|S 開発キットを使用している場合、アクティブ ソリューション
プラットフォームを Gaming.Xbox.Scarlett.x64 に設定します。

*詳細については、GDK のドキュメントの*
「サンプルの実行」*を参照してください。*

# サンプルの使用方法

devkit でシンプル ユーザー モデル
サンプルを起動するには、まずユーザーをサインインさせ、既定の devkit
ユーザーを設定する必要があります。既定のユーザーは、ユーザーの
\[自動サインイン\] にチェックを入れることで、*Xbox One Manager GDK*
を使用するユーザーになることができます。あるいは、\[xbconfig
DefaultUser\]
設定を使って設定することもできます。詳細については、「シンプル ユーザー
モデル」のドキュメントを参照してください。

このサンプルでは、既定のユーザーにサイレント サインインし、ゲーマー
タグとゲーマー
アイコンを画面に表示します。ユーザーがゲーマータグまたはゲーマー
アイコンを変更すると、画面上でも更新されます。\[表示\]
ボタンを押すとサンプルが終了します。

![Graphical user interface, application Description automatically generated](./media/image3.png)

# 実装上の注意

新しいシンプル ユーザー モデルでは、タイトルが 1
人の既定のユーザーを持つ予定の場合に、タイトルに必要なユーザー管理コードが大幅に簡略化されます。例としては、シングルプレイヤーゲーム、シングルユーザー常時オンラインタイトル、RPGなどが含まれます。

サンプルコードを見るときは、「\[シンプル ユーザ
モデル\]」のコメントを検索して、シンプル ユーザ
モデルの利用に関連する箇所を探してください。

タイトルのシンプル ユーザー モデルを有効にするには、MicrosoftGame.config
を編集し、次のエントリを追加する必要があります。

```
<!-- 起動時に既定のユーザーを要求し、シンプル ユーザー モデルを使用するようにします。-->

<AdvancedUserModel>false</AdvancedUserModel>
```

現在、2021 年 4 月と 2021 年 6 月の GDK
リリースでビルドされたタイトルの既定値は *true* です。これは、将来の GDK
メジャー リリースで既定で *false* に変更される可能性があります。2021 年
4 月より前のバージョンの GDK
でビルドされたタイトルでは、この設定は存在せず、使用可能なユーザー
モデルは高度なモデルのみです。

シンプルなユーザー
モデルを使用する場合、ユーザーのサインイン/サインアウト動作、ユーザー
イベント、PLM (プロセス有効期間管理)
イベント、関連する機能が変更され、古い高度なモデルを使用する場合よりも簡単な方法で処理できます。変更点と処理の簡略化方法については、次の表を参照してください。

| 機能  |  シンプルなユーザーモデルによる処理 |  高度なユ ーザーモデルによる処理 |
|----------|---------------------------------|------------------------|
| 既 定のユー ザー/プ ライマリ ユーザー  |  Xbox ホーム画面からタ イトルを起動するユーザーは、そ のタイトル有効期間中、固定の既 定ユーザーとして設定されます。  |  タイトルは 、タイトルのプライマリ ユーザ ーを手動で設定および管 理する必要があります。 詳細については、[XR-112](https://developer.microsoft.com/en-us/games/xbox/partner/xr112) を参照してください。   |
| サインイ ンとサイ ンアウト  |  *XUserAddAsync* と *AddDefaultUserSilently* フラグを使用して既 定のユーザーにサインインすると 、暗黙的な成功が保証されます。 既定のユーザーがサインアウトす ると、タイトルは中断されます。 既定のユーザーを超える 追加のユーザーは、上級ユーザー モデ ルの場合と同様に処理されます。  |  サインイ ンの試行が成功するかど うかは、仮定できません 。ユーザーがサインアウ トしても、タイトルは自 動的に中断されません。 代わりに、タイトルは [XR-115](https://developer.microsoft.com/en-us/games/xbox/partner/xr115) に従ってサイン インとサインアウトを処 理する必要があります。 |
| PLM  |  Xbox システムは、以前に起動し たユーザーとは異なるユーザーで Xbox ホーム画面からタ イトルを起動しようとすると、タ イトルを終了し、再起動します。 |  ユーザーやデバイス の変更/損失を引き起こ すものを含め、すべての PLM イベントを適切に処 理する必要があります。 |
| User イベント  |  既定のユーザーは、 サインイン/アウト関連のユーザー イベントを受信しません。 追加のユー ザーは、サインアウト/サインイン 関連のイベントを受け取ります。 すべてのユー ザーは、ゲーマータグやゲーマー アイコ ン変更イベントなどの他のユーザ ー変更イベントを受け取ります。 |  すべてのユーザ ーは、すべてのユーザー イ ベントを受信できます。 |

上記の表で説明した動作は、製品版コンソールでテストする場合、または Xbox
ホーム画面を使用して devkit
でアプリケーションを起動およびテストする場合の動作です。DevHome で
devkit を使用する場合、テスト ツールを使用して PLM
をテストする場合、またはその他の devkit
アプリケーションを使用する場合は、考慮すべき追加のケースがいくつかあります。

-   既定のユーザーをサインアウトし、新しいユーザーをサインインしてから、Xbox
    Manager アプリケーションまたはその他の PLM テスト
    ツールを使用してタイトルを手動で再開した場合、既定のユーザーは、ユーザーのサインアウト/サインイン関連イベントを取得できます。このケースは、小売用途で処理する必要はありません。

-   Xbox ホーム画面を使用して起動しない場合には、devkit
    でタイトルを起動するための既定のユーザーを設定する必要があります。これを行うには、Xbox
    マネージャー アプリケーションで \[自動サインイン\]
    にチェックを入れるか、または \[xbconfig DefaultUser\]
    設定を使用します。

複数のユーザーを処理する方法、ユーザーのサインイン/アウト
イベント、ゲームパッドのペアリング、XR
処理、およびその他のより高度なユーザー
トピックの詳細については、「UserManagement
サンプル」を参照してください。

# 更新履歴

**初回リリース:**Microsoft Game Development Kit (2021 年 6 月)

# プライバシーに関する声明

サンプルをコンパイルして実行する場合、サンプルの使用状況を追跡するために、サンプル実行ファイルのファイル名が
Microsoft に送信されます。このデータ
コレクションからオプトアウトするには、Main.cpp の「Sample Usage
Telemetry」というラベルの付いたコードのブロックを削除します。

全般的な Microsoft のプライバシー ポリシーの詳細については、「[Microsoft
プライバシー
ステートメント](https://privacy.microsoft.com/en-us/privacystatement/)」を参照してください。
