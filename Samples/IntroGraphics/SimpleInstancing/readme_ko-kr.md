![](./media/image1.png)

# 단순 인스턴싱 샘플

*이 샘플은 Microsoft 게임 개발 키트와 호환 가능합니다(2020년 6월).*

# 설명

이 샘플은 Direct3D 12 API를 사용한 인스턴싱 사용 방법을 보여줍니다.

# 샘플 빌드

Xbox One 개발 키트를 사용하는 경우 활성 솔루션 플랫폼을 `Gaming.Xbox.XboxOne.x64`(으)로 설정합니다.

Xbox One X|S 개발 키트를 사용하는 경우 활성 솔루션 플랫폼을 `Gaming.Xbox.Scarlett.x64`(으)로 설정합니다.

*자세한 내용은* *GDK 설명서의* __샘플 실행을__ 참조하세요.&nbsp;

# 샘플 사용

![](./media/image3.png)

| 동작 | Gamepad |
|---|---|
| 카메라 회전 | 왼쪽 엄지스틱 |
| 인스턴스 수 변경 | 왼쪽 범퍼/오른쪽 범퍼 |
| 시뮬레이션 재설정 | A |
| 끝내기 | 보기 버튼 |

# 구현 참고 사항

인스턴스화된 기하 도형을 렌더링할 때 네 가지 영역을 고려해야 합니다.

1. **기하학적 데이터**

> 이 샘플의 경우 큐브의 면을 설명하는 꼭짓점과 인덱스가 포함된
> 꼭짓점 및 인덱스 버퍼가 포함됩니다. 또한
> 이 큐브를 월드에 렌더링하는 데 필요한 *파이프라인 상태 개체* 도
> 포함됩니다. 이러한 모든 구성 요소는 인스턴스화되지 않은 기하 도형과
> 동일한 방식으로 설정 및 조작됩니다. (참조:
> SimpleInstancing.cpp의 *CreateDeviceDependentResources*)

2. **인스턴스 데이터**

> 표준 D3D12 인스턴스화된 렌더링의 경우 인스턴스별 데이터가 하나 이상의 꼭짓점
> 버퍼를 통해 제공됩니다. 이러한 꼭짓점 버퍼는 
> 다른 꼭짓점 버퍼와 동일한 방식으로 만들어집니다. 이 샘플에서는 두 가지 꼭짓점
> 버퍼를 사용합니다. 하나는 정적이며, 인스턴스별 색 데이터를 포함합니다
> (샘플 수명 동안 교환되지 않음). 다른 하나는
> 동적이며, 인스턴스별 위치 및 방향 정보를 포함합니다
> (모든 프레임을 변경함).

3. **레이아웃 인스턴싱**

> 인스턴스화된 기하 도형을 렌더링하려면 제공된 꼭짓점 데이터를
> 해석하는 방법에 대한 정보가 D3D에 필요합니다. 이 작업은
> *D3D12_INPUT_ELEMENT_DESC* 구조의 배열을 사용하여 수행되며,
> 표준 렌더링과 거의 동일한 방식입니다. 하지만 이 구조체에는 추가 요소가
> 더해집니다. 기하학적 데이터는 평소와 같이
> *D3D12_INPUT_CLASSIFICATION_PER_VERTEX_DATA* 값으로
> *InputSlotClass* 요소에 플래그가 지정되지만, 인스턴스별 데이터는
> *D3D12_INPUT_CLASSIFICATION_PER_INSTANCE_DATA* 값을 사용합니다. *InputSlot*
> 요소는 또한 각 데이터 조각을 가져오는 꼭짓점 스트림을
> 보여주는 데 사용됩니다.
>
> 꼭짓점 셰이더는 기하학적 데이터와 인스턴스별 데이터가
> 모두 함께 묶인 것처럼 정의된 꼭짓점 구조를 사용합니다(이는
> *D3D12_INPUT_ELEMENT_DESC* 배열에 설명된 레이아웃을
> 반영함).
>
> ***참고:** 이 샘플에서는* D3D12_APPEND_ALIGNED_ELEMENT
> *상수를* AlignedByteOffset 요소에 대해 사용하여 *입력 레이아웃에서 자동으로
> 데이터를 올바르게 맞춥니다. 이는 해당 꼭짓점 버퍼의 구조에 올바르게
> 정렬된 데이터가 포함된 경우에만 작동합니다. 다음과 같은 경우
> 꼭짓점 데이터 내의 요소를 건너 뛰거나 무시하는 경우
> 정확히 정렬된 오프셋이 필요합니다.*

4. **렌더링**

> 인스턴스화된 데이터 렌더링은 일단 이전 점이 고정되면
> 단순합니다. *ID3D12GraphicsCommandList::IASetVertexBuffers* API는
> 입력으로 사용되는 꼭짓점 버퍼(이 경우 입력 버퍼)를 설정하는 데 사용되며,
> *ID3D12GraphicsCommandList::D rawIndexedInstanced* API는
> 렌더링에 사용됩니다. 나머지 렌더링 설정은 표준 비인스턴스화
> 렌더링과 동일하게 수행됩니다.

# 개인정보처리방침

샘플을 컴파일하고 실행하는 경우 샘플 사용량을 추적할 수 있도록 샘플 실행 파일의 파일 이름이 Microsoft에 전송됩니다. 이 데이터 수집을 옵트아웃하려면 Main.cpp에서 "샘플 사용량 원격 분석"이라는 레이블이 지정된 코드 블록을 제거할 수 있습니다.

일반적인 Microsoft의 개인 정보 정책에 대한 자세한 내용은 [Microsoft 개인정보처리방침](https://privacy.microsoft.com/en-us/privacystatement/)을 참조하세요.


