  ![](./media/image1.png)

#   간단한 인스턴스화 샘플

*이 샘플은 Microsoft 게임 개발 키트 미리 보기(2019년 11월)와
호환됩니다.*

# 설명

이 샘플에서는 Direct3D 12 API에서 인스턴스화를 사용하는 방법을 보여
줍니다.

# 샘플 빌드

Xbox One 개발 키트를 사용하는 경우 활성 솔루션 플랫폼을
Gaming.Xbox.XboxOne.x64로 설정하세요.

Project Scarlett을 사용하는 경우 활성 솔루션 플랫폼을
Gaming.Xbox.Scarlett.x64로 설정하세요.

*자세한 내용은 GDK 문서에서* 샘플 실행하기*를 참조하세요.*

# 샘플 사용

![](./media/image3.png)

| 작업                                   |  게임패드                    |
|----------------------------------------|-----------------------------|
| 카메라 회전                            |  왼쪽 썸스틱                 |
| 인스턴스 수 변경                       |  LB/RB                       |
| 시뮬레이션 재설정                      |  A                           |
| 종료                                   |  보기 단추                   |

# 구현 참고 사항

인스턴스화한 기하 도형을 렌더링할 때는 다음 네 가지 영역을 고려해 야
합니다.

1.  **기하 데이터**

> 이 샘플에는 정육면체의 면을 설명하는 꼭짓점과 인덱스를 포함하는 꼭짓점
> 및 인덱스 버퍼가 포함됩니다. 또한 이 정육면체를 사용자를 위해
> 렌더링하는 데 필요한 *파이프라인 상태 개체*도 포함합니다. 이러한 모든
> 구성 요소는 인스턴스화되지 않은 기하 도형과 동일한 방식으로 설정되고
> 조작됩니다. (SimpleInstancing.cpp *CreateDeviceDependentResources*
> 참조)

2.  **인스턴스 데이터**

> 표준 D3D12 인스턴스화 렌더링의 경우 인스턴스별 데이터가 하나 이상의
> 정점 버퍼를 통해 제공됩니다. 이러한 정점 버퍼는 다른 정점 버퍼와 같은
> 방식으로 만들어집니다. 이 예제에서는 두 개의 정점 버퍼를 사용합니다.
> 하나는 정적이며, 샘플 수명 동안 변경되지 않는 인스턴스별 색 데이터를
> 포함합니다. 또 다른 버퍼는 동적이며 프레임마다 달라지는 인스턴스별
> 위치 및 방향 정보를 포함합니다.

3.  **레이아웃 인스턴스화**

> 인스턴스화된 기하 도형을 렌더링하려면 D3D에서 제공되는 정점 데이터를
> 해석하는 방법에 대한 정보가 필요합니다. 이 작업은 표준 렌더링이
> 수행되는 방식과 거의 동일하게 *D3D12_INPUT_ELEMENT_DESC* 구조체를
> 사용하여 수행합니다. 그러나 이 구조체에는 추가 요소가 추가됩니다. 기하
> 도형 데이터는 일반적으로 *InputSlotClass* 요소에 대해
> *D3D12_INPUT_CLASSIFICATION_PER_VERTEX_DATA* 값으로 플래그가
> 지정되지만 인스턴스별 데이터는
> *D3D12_INPUT_CLASSIFICATION_PER_INSTANCE_DATA* 값을 사용합니다.
> *InputSlot* 요소는 데이터의 각 부분을 끌어오는 정점 스트림을 나타내는
> 데도 사용됩니다.
>
> 정점 셰이더는 기하 데이터 및 인스턴스별 데이터가 모두 결합되는
> 것처럼(*D3D12_INPUT_ELEMENT_DESC* 배열에 설명된 레이아웃을 반영)
> 정의되는 정점 구조체를 사용합니다.
>
> ***참고:** 이 샘플은* AlignedByteOffset 요소*에 대해*
> D3D12_APPEND_ALIGNED_ELEMENT *상수를 사용하여 자동으로 입력 레이아웃에
> 데이터를 적절히 정렬합니다. 이 작업은 문제의 정점 버퍼 구조체에
> 올바르게 정렬된 데이터가 포함된 경우에만 수행됩니다. 정점 데이터
> 내에서 요소를 건너뛰거나 무시하는 경우에는 정확히 정렬 오프셋이
> 필요합니다.*

4.  **렌더링**

> 이전 점이 결정되면 인스턴스화 데이터가 간단하게 렌더링됩니다.
> *ID3D12GraphicsCommandList:: IASetVertexBuffers* API를 사용하여
> 입력(이 경우 입력 버퍼)로 사용되는 정점 버퍼를 설정하고,
> *ID3D12GraphicsCommandList::D rawIndexedInstanced* API를 사용하여
> 렌더링할 수 있습니다. 나머지 렌더링 설정은 인스턴스화되지 않은 표준
> 렌더링과 동일하게 수행됩니다.

# 개인정보처리방침

샘플을 컴파일하고 실행할 때 샘플의 사용을 추적하는 데 도움이 되도록 샘플
실행 파일의 파일 이름이 Microsoft에 전송됩니다. 이 데이터 수집을
옵트아웃하려면 Main.cpp에서 \"샘플 사용 원격 분석\"이라고 레이블이
지정된 코드 블록을 제거할 수 있습니다.

Microsoft의 일반 개인정보취급방침에 대한 자세한 내용은 [Microsoft
개인정보처리방침](https://privacy.microsoft.com/en-us/privacystatement/)을
참조하세요.
