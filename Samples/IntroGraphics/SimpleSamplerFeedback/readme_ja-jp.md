![](./media/image1.png)

# Simple SamplerFeedback サンプル

*このサンプルは Microsoft Game Development Kit (2020 年 6 月) と互換性があります*

# 説明

サンプラー フィードバックは、テクスチャ サンプリング情報と場所をキャプチャおよび記録するための Direct3D 機能です。 これは、テクスチャスペース シェーディングやテクスチャ ストリーミングなどに使用できます。 このサンプルでは、サンプラー フィードバックの非常に単純な実装のみを示します。

このサンプルでは、クワッドに向かって移動したり、クワッドから離したりできるカメラを使用してテクスチャ クワッドをレンダリングします。 カメラがクワッドに近づくと、レンダリング中に、より詳細なミップ (低いミップ レベル) が使用されます。 サンプラー フィードバックは、この情報を MinMip フィードバック マップに書き込みます。

注: サンプラー フィードバックは Xbox One ではサポートされていないため、
| | |
|---|---|
|Xbox Series X|S のみのサンプルです。|

![](./media/image3.png)

# サンプルのビルド

プラットフォームは Gaming.Xbox.Scarlett.x64 *詳細については、**GDK ドキュメントの*「__サンプルの実行__」を参照してください。
| | |
|---|---|
|このサンプルは Xbox Series X|S のみをサポートしているため、アクティブな解決策は|


# サンプルの使用方法

| 操作 | ゲームパッド |
|---|---|
| カメラを移動する | 左サム スティック |
| Exit | ビュー ボタン |

# 実装メモ

**作成**

フィードバック マップには、MinMip と RegionUsed という 2 つの形式があります。 このサンプルでは、MinMip フィードバックを実装します。つまり、DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE を使用して作成されています。

サンプラー フィードバックは通常、タイル リソースで使用されます。 そのため、フィードバック マップは通常、ペアになっているタイル テクスチャのサイズの一部 (つまり、64 KB タイルあたり 1 テクセル) としてサイズ変更されます。 この非常にシンプルなサンプルでは、1x1 のフィードバック マップ、つまり、テクスチャ全体に対して 1 つのフィードバック マップ値を作成します。

フィードバック マップをシェーダーにバインドし、通常のテクスチャをフィードバック マップにペアリングするには、API CreateSamplerFeedbackUnorderedAccessView を使用します。

**シーン レンダリング**

シーンレンダリングの前に、フィードバック マップをクリアする必要があります。 これは、シーンのレンダリング中にミップ レベル 0 が要求されたことを意味するため、値 0 にクリアできません。 したがって、このサンプルでは、ミップが要求されなかったことを示す -1 の値へのマップがクリアされます。

サンプラー フィードバック シェーダー命令は、シェーダー モデル 6.5 でサポートされています。 このサンプルのピクセル シェーダーは、WriteSamplerFeedback メソッドを使用しています。 ファイル pixelshader.hlsl には、サンプラー フィードバックをエミュレートするためのシェーダー コードも含まれています。これは、サンプラー フィードバックをサポートしていないプラットフォームで役立つ場合があります。

**読み返し**

CPU の値を読み取るには、ResolveSubresourceRegion を使用してフィードバック マップをトランスコードする必要があります。 このサンプルでは、読み返しテクスチャを作成します
フィードバック マップは 5.3 固定小数点です。
| | |
|---|---|
|読み返しに使用されます。 Xbox Series X|S では、その値

# 更新履歴

2019 年 12 月 5 日 -- サンプル作成。

# プライバシーに関する声明

サンプルをコンパイルして実行する場合、サンプルの使用状況を追跡するために、サンプルの実行可能ファイルのファイル名が Microsoft に送信されます。 このデータ コレクションからオプトアウトするには、Main.cpp の "サンプル使用状況テレメトリ" というラベルの付いたコードのブロックを削除します。

Microsoft のプライバシー ポリシー全般の詳細については、「[Microsoft のプライバシーに関する声明](https://privacy.microsoft.com/en-us/privacystatement/)」を参照してください。


