  ![](./media/image1.png)

#   简单 SamplerFeedback 示例

此示例与 Microsoft 游戏开发工具包预览版（2019 年 11 月）兼容

# 说明

采样器反馈是一项 Direct3D
功能，可以捕获和记录纹理采样信息和位置。可以将它用于纹理空间底纹和纹理流式处理，还有更多场景。本示例只演示采样器反馈的一个非常简单的实现。

本示例呈现一个带纹理的四边形，相机可以朝四边形的方向移动，也可以朝相反的方向移动。当相机靠近四边形时，呈现过程中会使用更高的细节
MIP（即 MIP 级别更低）。采样器反馈将此信息输出到 MinMip 反馈映射。

注意：Xbox One 不支持采样器反馈，因此本示例仅适用于 Scarlett。

![](./media/image3.png)

# 构建示例

本示例仅支持 Scarlett，因此，有效的解决方案平台是
Gaming.Xbox.Scarlett.x64

有关详细信息，请参阅 GDK 文档中的"运行示例"。

# 使用示例

| 操作                                   |  游戏手柄                    |
|----------------------------------------|-----------------------------|
| 移动相机                               |  左拇指摇杆                  |
| 退出                                   |  "视图"按钮                  |

# 实现说明

创建

存在两种格式的反馈映射，即 MinMip 和 RegionUsed。本示例将实现 MinMip
反馈，也就是说，要使用 DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE
来创建它。

采样器反馈通常用于平铺资源。因此，反馈映射的大小通常是其成对的平铺纹理的尺寸的一部分，即每
64 KB 平铺一个纹素。我们在这个非常简单的示例中创建一个 1x1
的反馈映射，即整个纹理的反馈映射值。

要将反馈映射绑定到着色器，并将常规纹理与反馈映射配对，可以使用 API
CreateSamplerFeedbackUnorderedAccessView。

场景呈现

在呈现场景之前，必须清除反馈映射。不能将其清除为零值，因为这将意味着在场景呈现期间已请求
MIP 级别 0。因此，本示例将映射清除到值 -1，这表示未请求任何 MIP。

着色器模型 6.5 支持采样器反馈着色器指令。本示例的像素着色器使用
WriteSamplerFeedback 方法。pixelshader.hlsl
文件还包含用于模拟采样器反馈的着色器代码，对于不支持采样器反馈的平台，这可能很有用。

读回

为了读取 CPU 上的值，必须使用 ResolveSubresourceRegion
对反馈映射进行转码。本示例创建用于读回的读回纹理。在 Scarlett
上，反馈映射中的值是 5.3 定点。

# 更新历史记录

2019 年 12 月 5 日 - 创建示例。

# 隐私声明

在编译和运行示例时，示例可执行文件的文件名将发送给
Microsoft，用于帮助跟踪示例使用情况。要选择退出此数据收集，你可以删除
Main.cpp 中标记为"示例使用遥测"的代码块。

有关 Microsoft 的一般隐私策略的详细信息，请参阅《[Microsoft
隐私声明](https://privacy.microsoft.com/en-us/privacystatement/)》。
