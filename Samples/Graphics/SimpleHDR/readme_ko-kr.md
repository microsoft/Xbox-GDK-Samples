# SimpleHDR 샘플

*이 샘플은 Microsoft 게임 개발 키트와 호환됩니다(2022년 3월).*

# 설명

Xbox에서 HDR을 구현하는 방법을 보여주는 간단한 샘플입니다.

![도형 설명이 자동으로 생성됨](./media/image1.png)

# 샘플 빌드

Xbox One 개발 키트를 사용하는 경우 활성 솔루션 플랫폼을 `Gaming.Xbox.XboxOne.x64`(으)로 설정합니다.

Project Scarlett을 사용하는 경우 활성 솔루션 플랫폼을 `Gaming.Xbox.Scarlett.x64`(으)로 설정합니다.

*GDK 설명서의* __샘플 실행__에서 *자세한 내용을 알아보세요.*

# 샘플 사용

이 샘플에서는 다음 컨트롤을 사용합니다.

| 동작 | Gamepad |
|---|---|
| 끝내기 | 보기 버튼 |

# 구현 참고 사항

HDR의 경우 Xbox 콘솔은 ST.2084 감마 곡선이 포함된 Rec.2020 색 공간에 있는 TV에 값을 보내야 합니다. 스왑 버퍼 형식, 색 공간 형식 및 셰이더 출력과 관련하여 Xbox One과 Xbox Series 콘솔에서 타이틀이 이를 처리하기 위한 다양한 요구 사항과 옵션이 있습니다. 시스템에는 GameDVR 및 스트리밍을 위한 SDR 이미지도 필요합니다. 타이틀은 이 SDR 이미지를 두 번째 스왑 체인 버퍼로 렌더링하거나 시스템에서 자동 톤 매핑을 사용하여 이 이미지를 자동으로 생성하도록 할 수 있습니다.

**Xbox One**

Xbox One에서 스왑 체인 버퍼는 `DXGI_FORMAT_R10G10B10A2_UNORM` 형식을 사용해야 하며 스왑 체인 색 공간 플래그는 DXGI_COLOR_SPACE_RGB_FULL\_**G2084**\_NONE\_**P2020**이어야 합니다. 이 플래그의 의미를 해독하는 것은 간단합니다. 그래픽 드라이버에 타이틀 셰이더가 **ST.2084** 감마 곡선이 적용된 **Rec.2020** 색 공간의 스왑 체인에 값을 쓰도록 지시합니다.

자동 톤 매핑을 옵트인하기 위해 타이틀이 스왑 체인 생성에 플래그 `D3D12XBOX_RESOURCE_FLAG_ALLOW_AUTOMATIC_GAMEDVR_TONE_MAP`을(를) 추가합니다. 이 시나리오에서 드라이버는 내부적으로 추가 스왑 체인을 할당하고 컴퓨팅 셰이더를 삽입하여 타이틀의 HDR 이미지를 톤 매핑하고 SDR 이미지를 생성합니다. 타이틀이 셰이더를 결합하여 자체 톤 매핑을 수행할 경우 성능이 더 나을 수 있습니다. PIX에서 드라이버의 자동 톤 매핑 셰이더는 프레젠테이션 호출 바로 앞에 PIX로 명명된 이벤트 "\[HDR 자동 톤맵\]"으로 식별할 수 있습니다.

**Xbox Series**

Xbox Series 콘솔에서 스왑 체인은 `DXGI_FORMAT_R9G9B9E5_SHAREDEXP` 또는 `DXGI_FORMAT_R10G10B10A2_UNORM`일 수 있습니다. DXGI_FORMAT\_**R9G9B9E5**\_SHAREDEXP를 사용하면 타이틀이 더 높은 정밀도 값을 표시할 수 있으므로 권장합니다.

스왑 체인 색 공간 플래그는 GPU에서 수행할 작업과 디스플레이 하드웨어에 오프로드되는 작업을 제어하는 여러 가지 중 하나일 수 있습니다. DXGI_COLOR_SPACE_RGB_FULL\_**G10**\_NONE\_**D65P3**을 사용하는 것이 좋습니다. 이 플래그의 의미를 해독하는 것은 Xbox One과 비슷합니다. 예를 들어 이전 플래그는 드라이버의 셰이더가 P3-D65 색 공간에서 선형 값 또는 감마 1.0을 출력하도록 지시합니다. 즉, 디스플레이 하드웨어는 색 값을 Rec.2020으로 변환하고 ST.2084 감마 곡선을 적용합니다. 이 권장 사항의 가장 큰 이유는 대부분의 HDR TV가 P3 색 값을 표시하거나 거의 표시할 수 있기 때문입니다. 타이틀이 단순히 Rec.709 색을 출력하는 경우 TV 디스플레이 기능을 과소 활용하는 것입니다. 이 샘플에서는 밝은 색을 더 다채롭게 만들면서도 대부분의 이미지를 동일하게 유지하기 위한 간단한 색 영역 확장을 보여줍니다.

자동 톤 매핑을 사용하기 위해 타이틀은 단순히 단일 스왑 체인을 표시할 수 있으며 Xbox One처럼 추가 플래그를 지정할 필요가 없습니다. 또한 추가 CPU, GPU, 메모리 또는 대역폭 비용이 없으며 모두 디스플레이 하드웨어에서 처리됩니다.

일부 처리를 디스플레이 하드웨어에 오프로드할 수 있다는 점은 특히 Lockhart 콘솔/에서 매우 유용합니다.

# 알려진 문제

없음

# 개인정보처리방침

샘플을 컴파일하고 실행하는 경우 샘플 사용량을 추적할 수 있도록 샘플 실행 파일의 파일 이름이 Microsoft에 전송됩니다. 이 데이터 수집을 옵트아웃하려면 Main.cpp에서 "샘플 사용량 원격 분석"이라는 레이블이 지정된 코드 블록을 제거할 수 있습니다.

일반적인 Microsoft의 개인 정보 정책에 대한 자세한 내용은 [Microsoft 개인정보처리방침](https://privacy.microsoft.com/en-us/privacystatement/)을 참조하세요.


