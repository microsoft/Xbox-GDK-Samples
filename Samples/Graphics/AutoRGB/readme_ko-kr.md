![](./media/image1.png)

# AutoRGB 샘플

*이 샘플은 Microsoft 게임 개발 키트(2023년 3월 QFE1)와 호환됩니다.*

# 설명

이 샘플은 주어진 장면에서 대표적인 단일 주변색을 추출하여 HID(연결된 디바이스)의 램프를 켜는 데 사용하는 방법을 보여줍니다. LampArray API를 사용하여 디바이스와 통신하므로 2023년 3월 QFE 1 GDK 이상 버전이 **필요**합니다.

![](./media/readme/image0.png)

> **참고:** 2023년 3월 QFE1 릴리스를 기준으로 GDK LampArray API는 콘솔에서 다음 디바이스만 지원합니다. 추가 디바이스에 대한 지원은 향후 복구 릴리스에서 추가될 예정입니다.
> - Xbox One용 Razer Turret(키보드 및 마우스)
> - Razer BlackWidow 토너먼트 에디션 Chroma V2

# 샘플 빌드

Xbox One 개발 키트를 사용하는 경우 활성 솔루션 플랫폼을 `Gaming.Xbox.XboxOne.x64`(으)로 설정합니다.

Xbox Series X|S를 사용하는 경우 활성 솔루션 플랫폼을 `Gaming.Xbox.Scarlett.x64`(으)로 설정합니다.

*자세한 내용은* *GDK 설명서의* __샘플 실행을__ 참조하세요.&nbsp;

# 컨트롤

| 동작 | Gamepad |
|---|---|
| 추론 간 전환 | A |
| 장면 색조 전환 | B |
| 모드 전환 | 예 |
| 표시등 토글(샘플 모드) | RB |
| 히스토그램 UI 토글 | LB |
| 색 전환 속도 수정 | 오른쪽/왼쪽 DPad |
| 기본 광원 강도 수정(샘플 모드) | 위쪽/아래쪽 DPad |
| 다음 이미지로 이동(스크린샷 모드) | RT |
| 이전 이미지로 이동(스크린샷 모드) | LT |
| 카메라 주변 모드(샘플 모드) | 위, 아래로 이동하려면 LT-RT 보기를 회전하려면 오른쪽 스틱 번역을 이동하려면 왼쪽 스틱 |
| 샘플을 종료합니다. | 보기 버튼 |

# 구현 참고 사항

샘플에서는 두 가지 모드를 보여 줍니다.

## 샘플 모드

![](./media/readme/image1.png)

첫 번째(기본값)는 카메라가 조명이 켜진 장면 주위로 자유롭게 이동할 수 있는 일반 샘플입니다. 장면은 현재 추출 중인 색을 나타내는 컬러 밴드를 둘러싸고 렌더링됩니다. 카메라는 장면 주위를 자유롭게 움직일 수 있으며, 색상은 실시간으로 업데이트됩니다(이전 프레임의 정보에서 계산되므로 1프레임 지연이 있음).

컨트롤을 사용하면 다음과 같은 방법으로 장면을 수정할 수 있습니다. 조명을 켜고 끌 수 있습니다(다양한 조명 수준과 추출된 색상이 어떻게 보이는지 테스트하기 위해). 또한 **기본 조명 강도** 레벨을 높이거나 낮추도록 제어할 수 있습니다. 0으로 설정하면 조명이 꺼졌을 때 장면이 완전히 어두워집니다. 샘플을 통해 대표 색상이 변하는 속도도 변경할 수 있습니다. 이 속도는 1프레임만큼 빠를 수 있지만 **색 전환 속도**를 줄여 더 매끄럽게 만들 수도 있습니다.

마지막으로 B를 누르면 샘플이 전체 장면에 빨강, 녹색 또는 파랑 색조를 적용합니다. 이는 전환 속도가 적절한지 또는 사용된 추론이 기본 사례를 제대로 처리하고 있는지 쉽게 테스트하기 위한 것입니다(아래에서 휴리스틱에 대해 자세히 설명합니다). B 버튼을 누르면 샘플이 무색조, 빨강, 파랑, 녹색 사이를 회전하다가 다시 무색조로 돌아갑니다. 이는 샘플 모드에만 해당됩니다.

## 스크린샷 모드

![](./media/readme/image2.png)

Y를 누르면 샘플이 모드 간에 전환됩니다. 스크린샷 모드는 동일한 색 밴드가 있는 게임의 정적 이미지를 표시합니다. 게임 패드 트리거를 통해 스크린샷을 탐색할 수 있습니다. 이는 추출된 색이 프로덕션 레벨 게임의 장면과 얼마나 잘 일치하는지 보여주기 위한 것입니다. 이 모드에서는 카메라를 이동할 수 없으며 색조 또는 기본 조명 강도도 수정할 수 없습니다.

# UI

샘플은 현재 장면(샘플 배경 또는 현재 선택된 스크린샷)에 대해 이미지 처리를 수행하고 아래와 같이 4개의 히스토그램을 얻는 패스(히스토그램 in PIX)를 거칩니다:

![](./media/readme/image3.png)

아래 이미지에는 장면에 빨간색 색조가 적용되어 있습니다. 이에 따라 히스토그램 UI가 변경되어 강도가 높은 구간에서 빨간색이 더 많이 표시됩니다. ![](./media/readme/image4.png)

처음 세 개의 히스토그램은 장면에 존재하는 빨강, 초록, 파랑의 양과 그 강도가 어떻게 분포되어 있는지를 나타냅니다. 각 히스토그램은 8개의 bin으로 나뉩니다. 각 색상의 강도는 0에서 255까지이므로 각 bin에는 저강도(왼쪽)에서 고강도(오른쪽)까지 32개의 강도 값이 포함됩니다. 각 bin의 높이는 해당 강도 범위에 속하는 픽셀 수에 해당합니다. 네 번째 히스토그램은 luma 구성 요소를 표시하며 장면의 광도를 측정하는 데 유용합니다.

> 일부 디바이스에서는 색상만 설정할 수 있지만, 다른 디바이스에서는 강도를 수정할 수도 있습니다.

# 경험적 접근

샘플이 히스토그램 형태의 색상 분포 정보를 얻으면 이를 사용하여 대표적인 주변 색상을 얻을 수 있습니다. 이를 위해서는 **추론**을 사용해야 합니다. 현재 이 샘플은 전체 장면에서 하나의 색상만 가져오는 것을 목표로 합니다(따라서 색상 위치에 대한 정보는 얻지 못합니다). 즉, 추론은 세 구성 요소(빨강, 녹색, 파랑)의 분포가 동일하고 회색으로 반환되지 않을 수 있는 경우를 처리하고 대신 장면에 더 많은 영향을 주는 색을 파생시켜야 합니다.

샘플에는 A 단추를 사용하여 변경할 수 있는 세 가지 추론이 있습니다. 다음은 세 가지에 대한 간략한 설명입니다.

1. 상위 X 버킷: 이 메서드는 세 가지 구성 요소 중 가장 높은 bin만 확인하여 시작합니다. 첫 번째 bin에 포함되는 픽셀의 양이 설정된 임계값을 초과하면 이 bin만 색을 계산하는 데 사용됩니다. 그렇지 않으면 다음 bin이 추가되고 프로세스가 반복됩니다. 이 추론의 개념은 픽셀 수를 고려하여 bin 수를 적응적으로 변경하는 동시에 더 높은 강도의 픽셀이 있는 색에 더 많은 가중치를 부여하는 것입니다.

2. 평균: 단순히 모든 히스토그램의 가중 평균을 사용하고 결과를 정규화합니다. 조명이 잘 켜진 장면에 대해서도 비슷한 결과를 제공하지만, 더 어두운 장면에서도 색을 확연하게 만드는 경향이 있습니다.

3. 버킷 x AVG(**기본값**): 이름에서 알 수 있듯이 이 추론은 이전 두 항목의 결과를 보간하고 그 사이의 결과를 제공합니다.

# 참고

# 업데이트 기록

2023/04/08 -- 이식된 샘플입니다.

# 개인정보처리방침

샘플을 컴파일하고 실행하는 경우 샘플 사용량을 추적할 수 있도록 샘플 실행 파일의 파일 이름이 Microsoft에 전송됩니다. 이 데이터 수집을 옵트아웃하려면 Main.cpp에서 "샘플 사용량 원격 분석"이라는 레이블이 지정된 코드 블록을 제거할 수 있습니다.

일반적인 Microsoft의 개인 정보 정책에 대한 자세한 내용은 [Microsoft 개인정보처리방침](https://privacy.microsoft.com/en-us/privacystatement/)을 참조하세요.


