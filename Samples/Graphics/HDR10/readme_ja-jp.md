# HDR10 Sample

*このサンプルは、Microsoft Game Development Kit と互換性があります (2022 年 3 月)*

# 説明

このサンプルは、HDR モードに UHD テレビを切り替え、UHD テレビで白より明るい色で表示される、1.0 f よりも高い値を持つ、HDR シーンをレンダリングします。 サンプルの目的は、使用する API の種類、HDR スワップチェーンを作成する方法、UHD テレビで 1.0f よりも大きい値がどれほど異なるのかを示すことです。

![タイムラインの説明文の自動生成を含む画像](./media/image1.png)

![説明は自動で生成されたものです](./media/image2.png)

# サンプルのビルド

Xbox One 開発キットを使用している場合は、アクティブなソリューション プラットフォームを `Gaming.Xbox.XboxOne.x64` に設定します。

Xbox Series X|S を使用している場合は、アクティブなソリューション プラットフォームを `Gaming.Xbox.Scarlett.x64` に設定します。

*詳細については、* *GDK ドキュメント*の「__サンプルの実行__」を参照してください。

# サンプルの使用方法

このサンプルでは、次のコントロールを使用します。

| 操作 | ゲームパッド |
|---|---|
| ST.2084 曲線の表示を切り替える | A button |
| ペーパー ホワイト ブロックのみへ切り替える | B button |
| ペーパー ホワイトの明るさを調整する | 方向パッド |
| 値の調整 | 左/右サム スティック |
| Exit | View button |

# 実装メモ

このサンプルでは、API を使用して、接続されたディスプレイが HDR 対応かどうかを判断します。 その場合は、ディスプレイが HDR モードに切り替わります。 値が 1.0f を超える非常にシンプルな HDR シーンは、FP16 バックバッファーにレンダリングされ、HDR 用と SDR 用の 2 つの異なるスワップチェーンに出力されます。 コンシューマーが HDR ディスプレイを使用する場合でも、GameDVR とスクリーンショットには SDR 信号が必要です。

このサンプルには、次のバージョンがあります。
[DeviceResources](https://github.com/Microsoft/DirectXTK12/wiki/DeviceResources)
HDR スワップチェーンと SDR スワップチェーンの両方をサポートするクラス。

ホワイト ペーパー「[HDR on Xbox One](http://aka.ms/hdr-on-xbox-one)」を参照してください。

これまで、ゲームは Rec.709 カラー プライマリと Rec.709 ガンマ曲線を使用して出力と SDR 信号を出力していました。 UHD ディスプレイの新機能の 1 つは、より広い色域 (WCG) です。 これを使用するには、新しい色空間 Rec.2020 カラー プライマリを使用する必要があります。 UHD ディスプレイのもう 1 つの新機能は、ハイ ダイナミック レンジ (HDR) です。 これを使用するには、別の曲線 ST.2084 曲線を使用する必要があります。 そのため、HDR 信号を出力するには、ST.2084 曲線で Rec.2020 カラー プライマリを使用する必要があります。

SDR 信号を表示するために、単純なトーンマッピング シェーダーを適用して HDR シーンの 1.0f より上のすべての値をクリップし、Rec.709 カラー プライマリを使用して 8 ビット値を出力します。 詳細は、
[PostProcess](https://github.com/Microsoft/DirectXTK12/wiki/PostProcess)
追加のトーン マッピング演算子用 *DirectX 12用 DirectX ツール キット* のクラス。

HDR 信号を表示するには、シェーダーを使用して Rec.709 カラー プライマリを Rec.2020 カラー プライマリに回転させ、ST.2084 曲線を適用して HDR ディスプレイが正しく表示できる 10 ビット値を出力します。 HDR ディスプレイの出力の白さと明るさは、"ペーパー ホワイト" を定義するために選択したニト値によって決まります。 SDR 仕様では"ペーパー ホワイト" を 80 nd として定義しますが、これは暗い環境の映画用です。 今日の消費者は、はるかに明るい白に使われています。たとえば、スマートフォンの場合は \~550 ニト (光で見ることができるように)、PC モニターの場合は 200 から 300 ニト、SDR テレビの場合は 120 から 150 ニトなどです。 "ペーパー ホワイト" のニトは、DPad の上下を使用してサンプルで調整できます。 白の横に明るい値を表示すると目に見える可能性があるため、"ペーパー ホワイト" ブロックのみを表示する場合は、A ボタンを使用して切り替えることができます。

このサンプルには、次の 2 つのモードがあります。

- シーン内の特定の値を持つブロックをレンダリングする

- 特定の明るさ値 (ニト) を使用して ST.2084 曲線をレンダリングする

# 既知の問題

実装は機能しますが、**HDRAutoToneMapping** や **SimpleHDR** の手法を使用してタイトルが HDR イメージのみを表示できるようにすることもできます。SDR 出力と GameDVR はシステムによって完全に処理されます。

# プライバシーに関する声明

サンプルをコンパイルして実行する場合、サンプルの使用状況を追跡するために、サンプルの実行可能ファイルのファイル名が Microsoft に送信されます。 このデータ コレクションからオプトアウトするには、Main.cpp の "サンプル使用状況テレメトリ" というラベルの付いたコードのブロックを削除します。

Microsoft のプライバシー ポリシー全般の詳細については、「[Microsoft のプライバシーに関する声明](https://privacy.microsoft.com/en-us/privacystatement/)」を参照してください。


