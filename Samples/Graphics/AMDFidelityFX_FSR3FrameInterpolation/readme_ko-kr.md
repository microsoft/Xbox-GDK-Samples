  ![](./media/image1.png)![](./media/image3.png)

#   FidelityFX 슈퍼 해상도

*이 샘플은 Microsoft 게임 개발 키트와 호환 가능합니다(2021년 4월)*

# 설명

AMD FidelityFX FSR(슈퍼 해상도)은 낮은 해상도 입력에서 고해상도 출력을
생성하기 위한 최적화된 고품질 솔루션입니다. 고품질 에지를 만드는 데 특히
중점을 둔 최첨단 알고리즘 컬렉션을 사용하여 기본 해상도에서 직접
렌더링하는 것에 비해 성능이 크게 향상됩니다. FSR은 하드웨어 레이
트레이싱과 같은 값비싼 렌더링 작업을 위한 \"실제적인 성능\"을 가능하게
합니다.

# 이 샘플에서는 장면에 대한 FSR 효과의 구현을 보여 줍니다. 네이티브 렌더링과 비교하도록 설정을 변경하는 동안 이미지 품질을 검사할 수 있는 이동 가능한 돋보기가 있습니다.

FidelityFX 슈터 해상도에 대한 최신 정보는 GPUOpen의
<https://gpuopen.com/fsr>에서 찾을 수 있습니다.

![](./media/image4.jpeg)

# 샘플 빌드

Windows Desktop을 사용하는 경우 활성 솔루션 플랫폼을
Gaming.Desktop.x64로 설정합니다.

Project Scarlett를 사용하는 경우 활성 솔루션 플랫폼을
Gaming.Xbox.Scarlett.x64로 설정합니다.

Xbox One 사용하는 경우 활성 솔루션 플랫폼을 Gaming.Xbox.XboxOne.x64로
설정합니다.

Windows Desktop을 실행할 때 시스템에 대한 최신 그래픽 드라이버가
설치되어 있는지 확인합니다.

*자세한 내용은 GDK 설명서에서* 샘플 실행*을 참조하세요.*

# 샘플 사용

| 작업                                  |  게임 패드                    |
|---------------------------------------|------------------------------|
| 보기 회전                             |  왼쪽 엄지스틱                |
| 돋보기 위치                           |  오른쪽 엄지스틱              |
| 종료                                  |  보기 버튼                    |
| FSR 켜짐/꺼짐                         |  단추                         |
| FSR 품질 모드                         |  X/Y 단추                     |
| RCAS 선명도 \[0.0(*가장 선명*함)에서 \> 0.0(*덜 선명*함)\] |  오른쪽/왼쪽 왼면 단추 |
| RCAS 사용/사용 안 함                  |  Dpad 위쪽 단추               |
| 톤맵 노출                             |  \[오른쪽, 왼쪽\] 트리거      |
| MIP 바이어스 조정                     | Dpad 왼쪽/오른쪽 단추        |

# 구현 참고 사항

## 방법

FSR은 공간 업스케일러입니다. 현재 앤티앨리어싱된 프레임을 가져와서
해상도를 표시하도록 업스케일링하여 작동합니다. FSR에는 현재 프레임의
데이터만 필요합니다. 동작 벡터 또는 프레임 기록이 필요하지 않습니다.
FSR의 핵심은 원본 이미지에서 고해상도 가장자리를 감지하고 다시 만드는
최첨단 알고리즘입니다. 이러한 고해상도 에지는 현재 프레임을 \"슈퍼
해상도\" 이미지로 바꾸는 데 필요한 중요한 요소입니다. FSR은 프레임이
이동 중인지 여부에 관계없이 일관된 업스케일링 품질을 제공하므로 다른
유형의 업스케일러에 비해 품질 이점을 제공할 수 있습니다.

FSR은 다음 두 가지 기본 패스로 구성됩니다.

-   에지 재구성을 수행하는 EASU(Edge-Adaptive Spatial Upsampling)()라는
    업스케일링 패스입니다. 이 패스에서 입력 프레임은 그라데이션 반전에
    대해 분석됩니다. - 인접 그라데이션이 입력 픽셀 세트와 어떻게 다른지
    확인합니다. 그라데이션 반전 강도는 디스플레이 해상도에서 재구성을
    위해 샘플에 적용되는 가중치를 결정합니다.

-   RCAS(Robust Contrast-Adaptive Sharpening)라고 하는 선명화
    패스(업스케일된 이미지에서 픽셀 세부 정보를 추출합니다.

이 샘플에서 두 개의 패스는 컴퓨팅 셰이더로 구현되며 gamma2 색상 공간
데이터에서 작동합니다.

Scarlett 및 XboxOne 플랫폼에서 HDR 디스플레이를 사용할 수 있는 경우
샘플은 HDR 모드에서 실행됩니다. 데스크톱 플랫폼에서 샘플은 SDR
모드에서만 실행됩니다.

이 샘플은 동적 해상도 스타일로 구현되어 대상 해상도 리소스가 사용되며
업스케일링 전에 더 작은 해상도 뷰포트를 사용하여 렌더링됩니다.

기본 대상 해상도 렌더링, 선택 가능한 저해상도에서 바이리니어 업스케일링,
선택 가능한 품질 모드에서 FSR 업스케일링을 위한 모드가 있습니다.

## ![](./media/image5.png)

## 프레임의 위치

![](./media/image6.png)

FSR 패스는 지각 색상 공간에서 가장 잘 작동하므로 톤 매핑 후에 통합해야
합니다. 장면에 노이즈 또는 기타 고주파수 시각적 구성 요소를 도입하는
패스는 이러한 노이즈 구성 요소가 증폭되는 것을 방지하기 위해 업스케일링
후에 렌더링되어야 합니다.

이 샘플에서는 다음 프레임 구조가 적용됩니다.

![](./media/image7.png)

샘플의 톤맵 패스는 gamma2 출력을 R10G10B10A2_UNORM 리소스에 씁니다. 이
리소스는 EASU 및 RCAS에서 소비한 다음 돋보기 패스에서 사용됩니다.
SDR에서 색상 변환 패스는 gamma2를 다시 선형으로 변환합니다. HDR에서 HDR
디스플레이가 연결된 상태에서 색상 변환 패스는 gamma2를 rec2020으로
변환합니다.

## 필수 상수

상수가 처리되는 방식은 통합을 가능한 한 간단하게 만드는 것과 같습니다.
CPU 또는 GPU에서 호출할 수 있는 도우미 함수로 채워지는 4개의 정수 벡터가
있습니다. 변수를 기존 상수 버퍼에 추가하고 추출한 다음 EASU/RCAS 기능에
전달할 수 있습니다.

이 샘플에서 도우미는 CPU에서 호출되고 상수는 단일 버퍼에서 제공됩니다.

> 구조체 FSRConstants
>
> {
>
> DirectX::XMUINT4 Const0;
>
> DirectX::XMUINT4 Const1;
>
> DirectX::XMUINT4 Const2;
>
> DirectX::XMUINT4 Const3;
>
> };
>
> FSRConstants m_fsrConsts;

**EASU**

> FsrEasuCon(
>
> reinterpret_cast\<AU1\*\>(&m_fsrConsts.Const0),
>
> reinterpret_cast\<AU1\*\>(&m_fsrConsts.Const1),
>
> reinterpret_cast\<AU1\*\>(&m_fsrConsts.Const2),
>
> reinterpret_cast\<AU1\*\>(&m_fsrConsts.Const3),
>
> inWidth, inHeight, // 크기를 조정할 입력 이미지의 뷰포트 크기(왼쪽
> 상단 정렬).
>
> outWidth, outHeight, // 입력 이미지의 크기입니다.
>
> outWidth, outHeight); // 출력 해상도.

위의 예는 지오메트리가 더 큰 리소스 내에서 뷰포트로 렌더링되는 동적
해상도 스타일에 대한 것입니다. 렌더링되는 리소스 크기가 뷰포트와
동일하면 다음이 표시됩니다.

> FsrEasuCon(
>
> reinterpret_cast\<AU1\*\>(&m_fsrConsts.Const0),
>
> reinterpret_cast\<AU1\*\>(&m_fsrConsts.Const1),
>
> reinterpret_cast\<AU1\*\>(&m_fsrConsts.Const2),
>
> reinterpret_cast\<AU1\*\>(&m_fsrConsts.Const3),
>
> inWidth, inHeight, // 크기를 조정할 입력 이미지의 뷰포트 크기(왼쪽
> 상단 정렬).
>
> inWidth, inHeight, // 입력 이미지의 크기입니다.
>
> outWidth, outHeight); // 출력 해상도.

입력이 레터박스 처리되고 뷰포트가 왼쪽 상단에 정렬되지 않은 경우 이를
수용하기 위해 FsrEasuConOffset 함수가 제공됩니다.

> void FsrEasuConOffset(
>
> outAU4 con0,
>
> outAU4 con1,
>
> outAU4 con2,
>
> outAU4 con3,
>
> AF1 inputViewportInPixelsX,
>
> AF1 inputViewportInPixelsY,
>
> AF1 inputSizeInPixelsX,
>
> AF1 inputSizeInPixelsY,
>
> AF1 outputSizeInPixelsX,
>
> AF1 outputSizeInPixelsY,
>
> AF1 inputOffsetInPixelsX,
>
> AF1 inputOffsetInPixelsY)

**RCAS**

> FsrRcasCon(reinterpret_cast\<AU1\*\>(&m_fsrConsts.Const0),
> m_rcasSharpness);

부동 소수점 선명도 값의 소수 자릿수는 다음과 같습니다.

> {0.0 := 최대값, N\>0까지, 여기서 N은 선명도 감소의
> 정지(으)개수입니다.}

*크기 조정은 FidelityFX CAS의 배율과 다릅니다*.

## 품질 모드

FSR은 원하는 품질/성능 비율에 따라 원본 이미지에 적용할 크기 조정의 양을
설명하는 품질 모드를 노출합니다.

고정 크기 조정 외에도 FSR을 \"임의 크기 조정\" 모드에서 사용할 수
있습니다. 1x에서 4x 사이의 모든 영역 배율 인수가 지원됩니다. 이 모드는
일반적으로 최소 프레임 속도를 달성하기 위해 고정 성능 예산에 따라 원본
해상도가 결정되는 동적 해상도 크기 조정에 사용됩니다.

| **FSR 1.0 품질 모드**  |  **설명**  |  **배율 인수**  |  **입력\ 해상도**  |  * *Output\ 해상도** |
|-------------|----------------------|-----------|----------|----------|
| **"울트라 품질"**  |  ***울트라 품질** 모드는 네이티브 렌더링과 거의 구별할 수 없는 품질로 이미지를 생성합니다. 최고 품질이 필요한 경우 선택해야 합니다.*  |  **1.3x** 차원당 (1.69x 영역 배율)  |  1477x831 1 970x1108 26 46x1108\ 2 954x1662  |  1 920x1080 2 560x1440 3 440x1440 3 840x2160 |
| **"품질"**  |  ***품질** 모드는 네이티브 렌더링의 품질을 나타내는 슈퍼 해상도 이미지를 생성하며, 크기가 큰 성능 향상을 제공합니다.*  |  **1.5x ** 차원당 (2.25배 영역 배율)  |  1280x720 1706x960 2293x960 2 560x1440  |  1 920x1080 2 560x1440 3 440x1440 3 840x2160 |
| **"균형"**  |  ***균형** 모드는 네이티브 렌더링 품질을 근사하게 만드는 슈퍼 해상도 이미지를 생성하며 네이티브에 비해 성능이 크게 향상됩니다.*  |  **1.7x** 차원당 (2.89x 영역 배율)  |  1129x635 1506x847 2024x847 2 259x1270  |  1 920x1080 2 560x1440 3 440x1440 3 840x2160 |
| **"성능"**  |  ***성능** 모드는 이미지 품질에 눈에 띄게 영향을 줍니다. 추가 성능이 필요한 경우에만 선택해야 합니다.*  |  **2.0x** 차원당 (4배 영역 배율)  |  960x540 1280x720 1720x720 1 920x1080  |  1 920x1080 2 560x1440 3 440x1440 3 840x2160 |

## 권장 사항

**형식, 컴파일러 옵션 및 부동 소수점 경로 선택**

이 샘플은 FSR 경로에 32bpp R10G10B10A2_UNORM 리소스를 사용하므로 성능이
가장 높습니다. EASU 패스는 일반적으로 ALU 바운드이고 RCAS는 MEM
바운드입니다.

이 샘플에 따라 구현될 때 지원되는 플랫폼에 대한 권장 사항은 다음과
같습니다.

| 플랫폼         |  리소스 종류    |  EASU 권장 사항  |  RCAS 권장 사항  |
|----------------|----------------|-----------------|-----------------|
| **Scarlett**  |  R10 G10B10A2_UNORM |  Wave32, Fp16  |  Wave64, Fp32 |
|  |  R16G 16B16A16_FLOAT |  Wave32, Fp16  |  Wave32, Fp16 |
| **XboxOne**  |  R10 G10B10A2_UNORM |  Fp32  |  Fp32 |
|  |  R16G 16B16A16_FLOAT |  Fp32  |  Fp32 |
| **데스크톱**  |  R10 G10B10A2_UNORM |  Fp16  |  Fp16 |
|  |  R16G 16B16A16_FLOAT |  Fp16  |  Fp16 |

장치 지원으로 인해 데스크탑 플랫폼에서 기본 fp16을 사용할 수 없는 경우
fp32가 사용됩니다.

**앤티앨리어스 입력**

FSR 1.0에는 앤티앨리어싱 입력이 필요합니다. 사용 가능한 품질 AA가 없는
경우(예: TAA 또는 MSAA 8x) FSR 사용은 권장되지 않습니다. 이 샘플에서는
기본 TAA가 사용됩니다.

**MIP 바이어스**

고품질 출력을 위해서는 FSR 통합에 MIP 바이어스 변경 사항이 포함되어야
합니다. 이 샘플은 다음을 적용합니다.

*MIP 바이어스 = -log2(디스플레이 해상도/소스 해상도)*

**색 공간**

FSR 패스에 대한 입력은 sRGB 또는 Gamma2와 같은 지각 색상 공간에 있어야
합니다. 이 밴딩이 증폭될 수 있으므로 입력에 밴딩이 없어야 합니다.

**동적 해상도를 위한 FSR**

FSR은 동적 해상도에 이상적이며 이 샘플은 입력 데이터가 더 큰 리소스의
하위 집합인 사용을 위해 상수를 설정하는 방법을 보여줍니다.

동적 해상도가 100%로 렌더링되는 특별한 경우에는 원활한 경험을 제공하기
위해 RCAS를 유지하면서 EASU 패스를 건너뛸 수 있습니다.

**RCAS 샤프닝**

RCAS에 대한 샤프닝 감쇠 값은 CAS에 존재하는 것과 다릅니다.

RCAS에서 0.0은 가장 높은 선명도 수준이며 N\>0은 적용된 선명도 수준을
줄입니다.

이 샘플의 기본 RCAS 선명도 감쇠는 0.25로 설정됩니다.

# 업데이트 기록

이 샘플은 2021년 6월에 작성되었습니다.

# 개인정보처리방침

샘플을 컴파일하고 실행하는 경우 샘플 사용량을 추적할 수 있도록 샘플 실행
파일의 파일 이름이 Microsoft에 전송됩니다. 이 데이터 수집을
옵트아웃하려면 \"샘플 사용량 원격 분석\"으로 레이블이 지정된
Main.cpp에서 코드 블록을 제거할 수 있습니다.

Microsoft의 개인정보 정책에 대한 자세한 내용은 [Microsoft 개인정보
처리방침](https://privacy.microsoft.com/en-us/privacystatement/)을
참조하세요.

# 면책사항

여기에 포함된 정보는 정보 제공의 목적으로만 제공되며 예고 없이 변경될 수
있습니다. 이 문서를 준비하는 동안 모든 예방 조치를 취했지만 기술적인
부정확성, 누락 및 인쇄상의 오류가 포함될 수 있으며 AMD는 이 정보를
업데이트하거나 수정할 의무가 없습니다. Advanced Micro Devices, Inc.는
여기에 설명된 AMD 하드웨어, 소프트웨어 또는 기타 제품의 작동 또는 사용과
관련하여 비침해, 상품성 또는 특정 목적에의 적합성에 대한 묵시적 보증을
포함하여 이 문서 내용의 정확성 또는 완전성과 관련하여 어떠한 진술이나
보증도 하지 않으며 어떤 종류의 책임도 지지 않습니다. 묵시적이거나
금반언에 의해 발생하는 것을 포함하여 이 문서에서는 지적 재산권에 대한
라이선스를 부여하지 않습니다. AMD 제품의 구매 또는 사용에 적용되는 약관
및 제한 사항은 당사자 간의 서명된 계약 또는 AMD의 표준 판매 약관에
명시되어 있습니다.

AMD, AMD Arrow 로고, Radeon, RDNA, Ryzen 및 이들의 조합은 Advanced Micro
Devices, Inc.의 상표입니다. 이 간행물에 사용된 기타 제품 이름은 식별
목적으로만 사용되었으며 해당 회사의 상표일 수 있습니다.

Windows는 미국 및/또는 기타 국가에서 Microsoft Corporation의 등록
상표입니다.

Xbox는 미국 및/또는 기타 국가에서 Microsoft Corporation의 등록
상표입니다.

© 2021 Advanced Micro Devices, Inc. All rights reserved.
