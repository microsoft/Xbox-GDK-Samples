![](./media/image1.png)

# 연기 시뮬레이션

*이 샘플은 Microsoft 게임 개발 키트(2022년 3월)와 호환됩니다.*

# 설명

이 샘플은 컴퓨트 셰이더 6.0 및 3D 텍스처를 사용하여 기본 3D Navier-Stokes 흐름 시뮬레이션을 구현하는 방법을 보여줍니다. 이 샘플에서는 간단한 광선 진행 알고리즘을 사용하여 볼류메트릭 데이터를 렌더링하는 방법도 보여줍니다.

![](./media/image3.png)

# 샘플 빌드

Xbox One 개발 키트를 사용하는 경우 활성 솔루션 플랫폼을 `Gaming.Xbox.XboxOne.x64`(으)로 설정합니다.

Xbox Series X|S 개발 키트를 사용하는 경우 활성 솔루션 플랫폼을 `Gaming.Xbox.Scarlett.x64`(으)로 설정합니다.

*GDK 설명서의* __샘플 실행__에서 *자세한 내용을 알아보세요.*

# 샘플 사용

이 샘플에서는 다음 컨트롤을 사용합니다.

| 동작 | Gamepad |
|---|---|
| 샘플을 종료합니다. | 선택 |
| 카메라 회전 | 오른쪽 스틱 |
| 이미터 회전 | 왼쪽 스틱 |
| 이미터 이동 | 왼쪽/오른쪽 트리거 |
| 이미터 방향 재설정 | X 버튼 |
| 시뮬레이션 일시 중지 설정/해제 | A 버튼 |
| 시뮬레이션 재설정 | B 버튼 |

# 구현 참고 사항

**시뮬레이션 기법**

이 샘플에 사용되는 시뮬레이션 기술에 대한 자세한 내용은 GPU의 GPU Gems 38장 빠른 유체 동적 시뮬레이션에서 찾을 수 있습니다. 이 문서에서는 시뮬레이션 기술을 설명하고 2D 유체에 적용하지만 이 샘플은 3D 데이터로 확장됩니다. 이 샘플에서 시뮬레이션은 3D 텍스처에 저장되는 상태인 128x128x128 그리드에서 실행됩니다.

컴퓨트 셰이더 5.0을 사용하여 3D 텍스처의 모든 조각을 한 번에 직접 조작할 수 있습니다. 그렇기 때문에 업데이트할 3D 텍스처 조각을 지정하는 데 사용할 수 있는 또 다른 전략인 기하 도형 셰이더를 사용하는 것보다 효율성이 높아질 수 있습니다.

**렌더링 기술**

시뮬레이션의 결과는 3D 속도 필드로, 특정 시뮬레이션 단계에서의 유체 상태를 나타냅니다. 속도는 직접 보이지 않으므로 속도장에 의해 운반되는 눈에 보이는 추적 입자가 있어야 합니다. 따라서 시뮬레이션 자체에 필요한 모든 3D 텍스처 외에도 이러한 입자를 저장하는 3D 텍스처도 갖추었습니다. 렌더링 단계에서 이 3D 텍스처를 시각화합니다.

렌더링할 때 큐브의 앞면을 렌더링합니다. 픽셀 셰이더에서는 눈 위치에서 큐브의 현재 지점으로 광선을 캐스팅하고, 색과 불투명도를 누적하면서 고정 간격으로 광선을 따라 마지막 단락에서 언급한 3D 텍스처를 샘플링합니다.

또한 이 샘플은 광선 캐스팅 알고리즘에 대한 단순하면서도 효과적인 가속 기술을 보여주었습니다. 시뮬레이션 중에 병렬 감소를 사용하여 1/8 크기의 3D 텍스처를 생성합니다. 렌더링할 때는 원래 3D 텍스처를 고정 간격으로 직접 샘플링하여 많은 시간을 빈 공간에 샘플링에 낭비하는 대신 먼저 이 1/8 크기의 3D 텍스처를 샘플링한 다음, 샘플링된 값이 임계값보다 작은 경우 공간에서 청크를 건너뜁니다. 이 기술은 3D 텍스처에 저장된 데이터가 충분하지 않을 때(예: 여기서의 연기) 특히 효과적입니다.

# 업데이트 기록

2019년 4월 -- 레거시 Xbox 샘플 프레임워크에서 새 템플릿으로 이식.

# 개인정보처리방침

샘플을 컴파일하고 실행하는 경우 샘플 사용량을 추적할 수 있도록 샘플 실행 파일의 파일 이름이 Microsoft에 전송됩니다. 이 데이터 수집을 옵트아웃하려면 Main.cpp에서 "샘플 사용량 원격 분석"이라는 레이블이 지정된 코드 블록을 제거할 수 있습니다.

일반적인 Microsoft의 개인 정보 정책에 대한 자세한 내용은 [Microsoft 개인정보처리방침](https://privacy.microsoft.com/en-us/privacystatement/)을 참조하세요.


