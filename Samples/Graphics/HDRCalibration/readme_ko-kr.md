# HDR 보정 샘플

*이 샘플은 Microsoft 게임 개발 키트(2022년 3월)와 호환됩니다.*

# 설명

HDR TV는 이미지 품질에 영향을 주는 HDR 기능과 관련하여 편차가 클 수 있습니다. 보급형 TV는 HDR을 물리적으로 재현하는 데 어려움이 있을 수 있고, 최대 밝기가 좋지 않을 수 있으며, 로컬 조명 대신 전체 패널 조명을 사용할 수도 있습니다. 이러한 차이를 보정하려면 게임상에서 고객이 게임의 HDR 이미지를 보정할 수 있어야 합니다. 이 샘플은 HDR TV를 HDR 모드로 전환한 다음 사용자에게 밝은 부분 및 어두운 부분에서 표시되는 세부 묘사와 이미지의 전체 밝기 및 채도를 조정하는 여러 보정 옵션을 제공합니다. 사용자가 이미지가 좋아 보일 때까지 조정하는 주관적 보정과 테스트 패턴을 표시하여 TV의 기능을 결정하는 객관적 보정의 두 가지 모드를 사용할 수 있습니다.

![](./media/image1.jpeg)

# 샘플 빌드

Xbox One 개발 키트를 사용하는 경우 활성 솔루션 플랫폼을 `Gaming.Xbox.XboxOne.x64`(으)로 설정합니다.

Xbox Series X|S를 사용하는 경우 활성 솔루션 플랫폼을 `Gaming.Xbox.Scarlett.x64`(으)로 설정합니다.

*자세한 내용은* *GDK 설명서의* __샘플 실행을__ 참조하세요.&nbsp;

# 샘플 사용

이 샘플에서는 다음 컨트롤을 사용합니다.

| 동작 | Gamepad |
|---|---|
| 보정 적용 토글 | A |
| 보정 화면 표시/숨기기 | X |
| 주관적 보정과 목표 보정 간 전환 | B |
| 보정 선택 | 방향 패드 위/아래 |
| 선택한 보정 조정 | 방향 패드 왼쪽/오른쪽 |

# 구현 참고 사항

**Brights의 세부 정보** -- TV가 표시할 수 있는 것보다 높은 HDR 값은 잘려나가므로 밝은 부분의 디테일이 손실됩니다. 장면의 매우 밝은 HDR 값을 TV의 최대 밝기에 매핑할 수 있도록 TV의 최대 인식 밝기를 결정해야 합니다. 보정 이미지는 ST.2084 사양의 최대 밝기인 10,000니트를 나타내는 값을 장면에 렌더링합니다. 그런 다음 현재 밝기로 더 작은 이미지가 렌더링됩니다. 사용자는 두 이미지를 더 이상 구분할 수 없을 때까지 현재 밝기 값을 조정합니다. 예를 들어 TV가 1,000니트를 표시할 수 있는 경우 1,000니트보다 더 밝은 픽셀을 나타내는 장면에 렌더링된 값은 여전히 1,000니트로 인식됩니다. HDRDisplayMapping 샘플을 참조하세요. 이 값의 기본 시작점으로 Xbox 시스템 HDRGameCalibration의 MaxToneMapLuminance 값을 사용합니다. 소비자는 콘솔 설정의 '게임용 HDR 보정' 옵션에서 앱에 액세스할 수 있습니다.

**어두운 장면의 디테일** - 대부분의 게임에는 메뉴에 디스플레이 감마를 결정하는 비디오 옵션이 있습니다. 픽셀 셰이더의 파워 함수를 사용하여 대비를 보정하면 어두운 부분의 디테일을 정확하게 볼 수 있습니다. 이 조정은 TV가 HDR 모드일 때 매우 중요합니다. 적절한 조정이 없으면 HDR 이미지는 SDR 이미지에 비해 "평면" 및 고해상도로 표시됩니다. 일부 LCD TV의 시야각에 따라 작은 각도에서도 이미지의 대비가 달라질 수 있으므로 보정 화면을 화면 중앙에 렌더링하는 것이 중요합니다. 예를 들어 LCD 화면의 측면에서 보정 이미지를 렌더링하는 경우 결정된 디스플레이 감마 값은 화면 중앙에서 렌더링할 때와 약간 달라집니다. 깜박이는 이미지를 사용하면 중앙 보정 블록이 보이지 않게 되는 시점을 사용자가 쉽게 확인할 수 있으므로 이 보정에 효과적입니다. 대비 조정을 일부 적용하면 최대 HDR 장면 값이 변경되며, 이는 효과적인 HDR 디스플레이 매핑을 위해 중요하므로 대비 조정 기능을 HDR 디스플레이 매핑에 들어가는 최대 장면 값에도 적용해야 합니다.

**전체 밝기** -- 보급형 HDR TV는 최고 밝기가 높지 않습니다. HDR을 표시하려면 이미지의 SDR 범위 밝기를 희생해야 하므로 SDR TV와 비교했을 때 이미지가 더 나빠 보일 수 있습니다. 예를 들어, 좋은 HDR TV는 100니트를 렌더링할 때 100니트를 출력하지만 보급형 TV는 100니트를 렌더링할 때 30니트만 출력할 수 있습니다. 따라서 소비자가 이미지에서 SDR 범위의 밝기를 조정할 수 있도록 해야 합니다. 이는 종이의 흰색 니트 값을 조정하여 수행합니다. 종이의 흰색이 높아질수록 HDR의 잠재적 범위가 줄어든다는 점에 유의하세요. 따라서 밝은 부분의 디테일이 많은 HDR 이미지를 보여줌으로써 소비자가 더 밝은 SDR 범위와 더 작은 HDR 범위의 타협점을 이해할 수 있도록 하는 것이 좋습니다.

**색 채도** -- HDR TV의 디스플레이 패널은 모두 Rec.709 색 공간을 벗어난 색상을 생성할 수 있기 때문에 매우 밝고 다채로운 이미지를 생성할 수 있습니다. SDR 모드에서 TV는 종종 색 영역 확장을 사용하여 SDR 이미지를 더욱 다채롭게 보이게 합니다. HDR 모드에서 이론적으로 정확한 색상을 렌더링할 때 이미지가 SDR 모드보다 덜 다채로워 보일 수 있습니다. 이 문제의 해결 방법은 게임 내에서 색 영역 확장을 수행하는 것입니다. 이 옵션은 색 영역 확장을 얼마나 적용할지 제어합니다.

테스트 패턴으로 객관적 보정을 사용할 때는 실제 밝기 보정 블록에 디스플레이 감마나 소프트 숄더를 적용하면 감지된 최대 밝기 값이 변경될 수 있으므로 주의하세요. 샘플에서는 블록의 바운딩 박스를 사용하여 이를 무시하지만 여전히 배경의 미리보기 이미지에 적용합니다. 예를 들어, TV의 최대 인식 밝기를 확인하려고 할 때 디스플레이 감마 조정을 사용하면 잘못된 값이 표시됩니다.

백서 "[Xbox One의 HDR](http://aka.ms/hdr-on-xbox-one)" 및 HDRDisplayMapping 샘플을 참조하세요.

*테스트 이미지는 Turn 10 Studios에서 개발하고 Microsoft Studios에서 게시한 **Forza Horizon 3에서 캡처한 스크린샷*

# 알려진 문제

없음

# 업데이트 기록

2019년 6월 초기 릴리스

# 개인정보처리방침

샘플을 컴파일하고 실행하는 경우 샘플 사용량을 추적할 수 있도록 샘플 실행 파일의 파일 이름이 Microsoft에 전송됩니다. 이 데이터 수집을 옵트아웃하려면 Main.cpp에서 "샘플 사용량 원격 분석"이라는 레이블이 지정된 코드 블록을 제거할 수 있습니다.

일반적인 Microsoft의 개인 정보 정책에 대한 자세한 내용은 [Microsoft 개인정보처리방침](https://privacy.microsoft.com/en-us/privacystatement/)을 참조하세요.


